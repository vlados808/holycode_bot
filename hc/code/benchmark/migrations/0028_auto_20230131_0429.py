# Generated by Django 4.1.4 on 2023-01-31 04:29
from hashlib import md5

from django.db import migrations


def change_vacancy_id(apps, schema_editor):
    Vacancy = apps.get_model('benchmark', 'Vacancy')
    all_vc = Vacancy.objects.all()
    print(f'GET {len(all_vc)} PUBLICATIONS')
    for vc in all_vc:
        value = ''.join([
            vc.source.name,
            vc.source_number,
            vc.name,
            vc.project
        ])
        print(value)
        value = value.encode('utf-8')
        value = md5(value)
        value = value.hexdigest()
        vc.vacancy_id = value
        vc.save()


class Migration(migrations.Migration):

    dependencies = [
        ('benchmark', '0027_auto_20230130_0626'),
    ]

    operations = [
        migrations.RunPython(change_vacancy_id),
    ]
